<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/global.css">
    <title>Cadastro Funcion√°rio</title>
</head>
<body>
    <div>
        <img  class="logo" src="./img/logo.png" alt="Logo da empresa">
    </div>
    <div>
         <form class="formfuncionario"  action="formulariofuncionario">
            <h1 class="title">Cadastre-se</h1>
            <label class="dados" for="nome">Nome completo:</label>
            <input type="text" id="nome">
             <label class="dados" for="estado">Estado:</label>
                <select class="dados" id="estado" name="estado">
                    <option  value="">Carregando estados...</option>
                </select>

                <label class="dados" for="cidade">Cidade:</label>
                <select class="dados" id="cidade" name="cidade" disabled>
                    <option value="">Selecione o estado primeiro</option>
                </select>

                <style>
                    select.dados {
                        width: 100%;
                        padding: 8px;
                        margin-bottom: 10px;
                        border: 1px solid #ccc;
                        border-radius: 4px;
                        box-sizing: border-box;
                    }
                </style>

                <script>
                    const estadoSelect = document.getElementById('estado');
                    const cidadeSelect = document.getElementById('cidade');

                    // üîπ 1. Carrega os estados da API IBGE
                    fetch('https://servicodados.ibge.gov.br/api/v1/localidades/estados?orderBy=nome')
                    .then(res => res.json())
                    .then(estados => {
                        estadoSelect.innerHTML = '<option value="">Selecione o estado</option>';
                        estados.forEach(uf => {
                        const option = document.createElement('option');
                        option.value = uf.id;
                        option.textContent = uf.nome;
                        estadoSelect.appendChild(option);
                        });
                    })
                    .catch(err => {
                        console.error('Erro ao carregar estados:', err);
                        estadoSelect.innerHTML = '<option>Erro ao carregar estados</option>';
                    });

                    // üîπ 2. Quando o estado muda, carrega as cidades
                    estadoSelect.addEventListener('change', () => {
                    const estadoId = estadoSelect.value;
                    cidadeSelect.innerHTML = '<option>Carregando cidades...</option>';
                    cidadeSelect.disabled = true;

                    if (!estadoId) {
                        cidadeSelect.innerHTML = '<option>Selecione o estado primeiro</option>';
                        cidadeSelect.disabled = true;
                        return;
                    }

                    fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${estadoId}/municipios`)
                        .then(res => res.json())
                        .then(cidades => {
                        cidadeSelect.innerHTML = '<option value="">Selecione a cidade</option>';
                        cidades.forEach(c => {
                            const option = document.createElement('option');
                            option.value = c.nome;
                            option.textContent = c.nome;
                            cidadeSelect.appendChild(option);
                        });
                        cidadeSelect.disabled = false;
                        })
                        .catch(err => {
                        console.error('Erro ao carregar cidades:', err);
                        cidadeSelect.innerHTML = '<option>Erro ao carregar cidades</option>';
                        });
                    });
                </script>
            <label class="dados" for="rg">RG:</label>
            <input type="number" id="rg">
            <label class="dados" for="cpf">CPF:</label>
            <input type="number" id="cpf">
            <label class="dados" for="senha">Criar senha:</label>
            <input type="password" id="senha">
            <input class="bot√£o" type="submit" value="Cadastrar">
         </form>
    </div>
    <footer>
        <p class="rodape"><b>Desenvolvido por Aquasense &copy; 2025</b></p>
    </footer>
    <div vw class="enabled">
            <div vw-access-button class="active"></div>
            <div vw-plugin-wrapper>
            <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>
        <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
        <script>
            new window.VLibras.Widget('https://vlibras.gov.br/app');
        </script>

        <!-- === Leitor Fal√°vel Interativo === -->
        <style>
        #voiceReaderToggle {
            position: fixed;
            bottom: 90px;
            right: 16px;
            background: #0078d7;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 18px;
            font-size: 15px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 9999;
        }

        #voiceReaderToggle.active {
            background: #00a86b;
        }

        .reading-highlight {
            background-color: rgba(255, 255, 0, 0.3);
            transition: background-color 0.3s ease;
        }

        #readAllButton {
            position: fixed;
            bottom: 150px;
            right: 16px;
            background: #0078d7;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 18px;
            font-size: 15px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 9999;
        }
        </style>

            <button id="voiceReaderToggle" aria-pressed="false" title="Ativar leitor falado">üó£Ô∏è Leitor</button>
            <button id="readAllButton" title="Ler toda a p√°gina">üìñ Ler Tudo</button>

            <script>
            (function() {
            let active = false;
            let synth = window.speechSynthesis;
            let currentUtterance = null;
            const btn = document.getElementById('voiceReaderToggle');
            const readAllBtn = document.getElementById('readAllButton');

            if (!('speechSynthesis' in window)) {
                btn.textContent = 'üîá Sem suporte';
                btn.disabled = true;
                readAllBtn.disabled = true;
                alert('Seu navegador n√£o suporta leitura por voz (SpeechSynthesis).');
                return;
            }

            function getAllTextNodes() {
                const texts = [];
                const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                {
                    acceptNode: function(node) {
                    return node.parentNode.tagName !== 'SCRIPT' && 
                            node.parentNode.tagName !== 'STYLE' && 
                            node.textContent.trim() !== '' 
                            ? NodeFilter.FILTER_ACCEPT 
                            : NodeFilter.FILTER_REJECT;
                    }
                }
                );

                let node;
                while (node = walker.nextNode()) {
                texts.push(node);
                }
                return texts;
            }

            function readText(text, element) {
                return new Promise((resolve) => {
                if (synth.speaking) synth.cancel();
                
                if (element) element.classList.add('reading-highlight');
                
                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = 'pt-BR';
                utter.rate = 1.0;
                
                utter.onend = () => {
                    if (element) element.classList.remove('reading-highlight');
                    resolve();
                };

                synth.speak(utter);
                currentUtterance = utter;
                });
            }

            async function readAllTexts() {
                const textNodes = getAllTextNodes();
                
                for (let node of textNodes) {
                if (!active) break;
                const text = node.textContent.trim();
                if (text) {
                    await readText(text, node.parentElement);
                }
                }
            }

            btn.addEventListener('click', () => {
                active = !active;
                btn.classList.toggle('active', active);
                btn.setAttribute('aria-pressed', active);
                btn.textContent = active ? 'üü¢ Leitor Ativo' : 'üó£Ô∏è Leitor';
                if (!active && synth.speaking) synth.cancel();
            });

            readAllBtn.addEventListener('click', () => {
                if (!active) {
                active = true;
                btn.classList.add('active');
                btn.setAttribute('aria-pressed', true);
                btn.textContent = 'üü¢ Leitor Ativo';
                }
                readAllTexts();
            });

            document.addEventListener('click', (e) => {
                if (!active || e.target.id === 'voiceReaderToggle' || e.target.id === 'readAllButton') return;

                if (synth.speaking) synth.cancel();
                document.querySelectorAll('.reading-highlight').forEach(el => el.classList.remove('reading-highlight'));

                const text = e.target.innerText || e.target.textContent;
                if (text && text.trim().length > 0) {
                readText(text.trim(), e.target);
                }
            });
            })();
        </script>
</body>
</html>
